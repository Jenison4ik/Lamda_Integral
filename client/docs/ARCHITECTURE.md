# Архитектура клиента (React)

Используется **слоёная (layer-based)** структура — один из самых распространённых подходов в React-приложениях.

## Слои (снизу вверх)

| Слой | Папка | Назначение |
|------|--------|------------|
| **API / Service** | `service/` | Вызовы бэкенда. Один модуль на домен (users, auth, questions). Без UI, без хуков. |
| **Hooks** | `hooks/` | Переиспользуемая логика: состояние, побочные эффекты, подписки. Используют service. |
| **Components** | `components/` | UI-кирпичики (кнопки, карточки, спиннеры). Без прямых fetch, при необходимости используют хуки. |
| **Providers** | `providers/` | Глобальное состояние и контекст (тема, роут, app state). |
| **Pages** | `pages/` | Экраны/страницы. Композиция компонентов + хуки + провайдеры. |

## Поток данных

```
Page → useHook() → service.api() → fetch /api/...
         ↓
    setState / context
         ↓
    UI (LoadScreen / Content)
```

- **Страница** решает, какой хук вызвать и что показать (loading / content / error).
- **Хук** знает, когда и как вызывать API и как обновлять состояние.
- **Сервис** знает только URL, метод и тело запроса; не знает про React.

## Пример (инициализация пользователя)

1. **service/users.ts** — `ensureUser()` → `POST /api/users` с `initData`, возвращает результат.
2. **hooks/useUsersInit.ts** — при монтировании вызывает `ensureUser`, хранит `isReady`, `error`, `result`; можно переиспользовать в любом экране.
3. **pages/MiniApp/index.tsx** — вызывает `useUsersInit()`, при `!isReady` рендерит `<LoadScreen />`, иначе контент.

Так логика запроса и состояния живёт в одном месте, а экран остаётся тонким и читаемым.

## Альтернативы

- **Feature-Sliced Design (FSD)** — срезы по фичам (features/users, features/quiz), внутри каждого — свои api, model, ui. Удобно в больших командах.
- **Colocation** — всё по фичам рядом (компонент + хук + запрос в одной папке). Меньше слоёв, проще на старте.

Текущий выбор — слои по типам (service, hooks, components, pages) — даёт предсказуемое место для нового кода и хорошо масштабируется без усложнения структуры.
